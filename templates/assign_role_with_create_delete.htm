<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Assign Roles</title>
    <script>
        function showForm(formId) {
            document.getElementById('createForm').style.display = 'none';
            document.getElementById('updateForm').style.display = 'none';
            document.getElementById('deleteForm').style.display = 'none';
            document.getElementById(formId).style.display = 'block';
        }
    </script>
    <script>
        function submitRoleForm() {
            document.getElementById('deleteForm').submit();
        }
    </script>
</head>
<body>
    <h1>Assign Roles to Users</h1>
    
    <button onclick="showForm('createForm')">Create New User</button>
    <button onclick="showForm('updateForm')">Update User</button>
    <button onclick="showForm('deleteForm')">Delete User</button>
    
    <form id="createForm" style="display:none" method="post">
        <input type="hidden" name="action" value="create">
        Username: <input type="text" name="username" required><br>
        Password: <input type="password" name="password" required><br>
        Role: <select name="role">
                <option value="admin">Admin</option>
                <option value="developer">Developer</option>
                <option value="user">Other User</option>
              </select><br>
        <input type="submit" value="Submit">
    </form>

    <form id="updateForm" style="display:none" method="post">
        <input type="hidden" name="action" value="update">
        Username: <select name="username">
                    {% for user in users %}
                    <option value="{{ user[0] }}">{{ user[0] }}</option>
                    {% endfor %}
                  </select><br>
        New Role: <select name="role">
                    <option value="admin">Admin</option>
                    <option value="developer">Developer</option>
                    <option value="user">Other User</option>
                  </select><br>
        <input type="submit" value="Submit">
    </form>
    
    <form id="deleteForm" style="display:none;" method="post">
        <input type="hidden" name="action" value="delete">
        <label for="roleToDelete">Select Role to Delete:</label>
        <select name="role" id="roleToDelete">
            <option value="">Select Role</option>
            {% for role in roles %}
            <option value="{{ role }}" {% if selected_role == role %} selected {% endif %}>{{ role }}</option>
            {% endfor %}
        </select>
        <button type="button" onclick="submitRoleForm()">Select Role</button>
    </form>

    {% if users %}
    <form method="post" style="display:block;">
        <input type="hidden" name="action" value="perform_delete">
        <label for="usernameToDelete">Select User to Delete:</label>
        <select name="username" id="usernameToDelete">
            <option value="">Select User</option>
            {% for user in users %}
            <option value="{{ user[0] }}">{{ user[0] }}</option>
            {% endfor %}
        </select>
        <input type="submit" value="Delete">
        <button type="button" onclick="location.href='/assign_role'">Cancel</button>
    </form>
    {% endif %}

    

</body>
</html>
